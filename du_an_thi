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 : token github

CÃ³ thá»ƒ cÃ³ attribute táº¡m thá»i (attr_accessor) khÃ´ng lÆ°u vÃ o database.
CÃ³ kháº£ nÄƒng Ã¡nh xáº¡ tÃªn dá»±a theo quy táº¯c Ä‘áº·t tÃªn trong model Ä‘á»ƒ Ã¡nh xáº¡ tá»›i table 
CÃ³ thá»ƒ Ä‘áº·t tÃªn cho cÃ¡c báº£ng Ä‘á»ƒ cÃ³ tiá»n tá»‘ háº­u tá»‘ máº·c Ä‘á»‹nh vÃ­ dá»¥ ralis g creat book::order (tiá»n tá»‘ lÃ  book)
sá»­ dá»¥ng migratation Ä‘á»ƒ táº¡o báº£ng thÃ¬ trÆ°á»ng id sáº½ Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng vÃ  trÆ°á»ng id thÆ°á»ng lÃ  trÆ°á»ng Ä‘á»ƒ lÃ m khÃ³a chÃ­nh 
dÃ¹ng self Ä‘á»ƒ ghi Ä‘Ã¨ nhá»¯ng name máº·c Ä‘á»‹nh trong model 
Callbacks giÃºp thá»±c hiá»‡n hÃ nh Ä‘á»™ng trÆ°á»›c hoáº·c sau khi thao tÃ¡c trÃªn báº£n ghi. 
------------------------------------------------------------------------------------
Migrate 
rails db:migrate:status Kiá»ƒm tra danh sÃ¡ch migration Ä‘Ã£ cháº¡y:
rails db:rollback STEP=1  # Quay vá» 1 bÆ°á»›c trÆ°á»›c Ä‘Ã³
rails db:migrate          # Cháº¡y láº¡i migration
------------------------------------------------------------------------------------
Schema lÃ  báº£n ghi chÃ©p vá» cáº¥u trÃºc database, giÃºp Rails hiá»ƒu tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a database.

XÃ³a database rails db:drop
Lá»‡nh nÃ y sáº½ xÃ³a hoÃ n toÃ n database, bao gá»“m táº¥t cáº£ báº£ng, dá»¯ liá»‡u, vÃ  tráº¡ng thÃ¡i migration (schema_migrations).
------------------------------------------------------------------------------------
Model 
bin/rails generate model Product name:string price:decimal
Lá»‡nh nÃ y sáº½:
Táº¡o file model:
ğŸ“„ app/models/product.rb
Táº¡o file migration:
ğŸ“„ db/migrate/20250303120000_create_products.rb
------------------------------------------------------------------------------------
schema
Schema lÃ  báº£n ghi chÃ©p vá» cáº¥u trÃºc database, giÃºp Rails hiá»ƒu tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a database.
XÃ³a database rails db:drop
Lá»‡nh nÃ y sáº½ xÃ³a hoÃ n toÃ n database, bao gá»“m táº¥t cáº£ báº£ng, dá»¯ liá»‡u, vÃ  tráº¡ng thÃ¡i migration (schema_migrations).
bin/rails db:schema:load
âœ… Lá»‡nh nÃ y sáº½ bá» qua migration vÃ  táº¡o database tá»« schema.rb.
âš ï¸ LÆ°u Ã½: NÃ³ sáº½ xÃ³a toÃ n bá»™ dá»¯ liá»‡u trong database trÆ°á»›c khi táº¡o láº¡i!
bin/rails db:migrate
âœ… Lá»‡nh nÃ y sáº½ cháº¡y táº¥t cáº£ migration vÃ  tá»± Ä‘á»™ng cáº­p nháº­t schema.rb.
bin/rails db:schema:dump
âœ… Lá»‡nh nÃ y chá»‰ ghi láº¡i cáº¥u trÃºc database vÃ o schema.rb mÃ  khÃ´ng cháº¡y migration.
schema.rb khÃ´ng lÆ°u láº¡i lá»‹ch sá»­ thay Ä‘á»•i cá»§a database. NÃ³ chá»‰ chá»©a tráº¡ng thÃ¡i cuá»‘i cÃ¹ng cá»§a database sau khi cháº¡y migration gáº§n nháº¥t.
Äá»•i loáº¡i schema dump máº·c Ä‘á»‹nh trong config/application.rb:
config.active_record.schema_format = :sql  # Hoáº·c :ruby

-------------------------------------------------------------------------------------
Miragation 
Lá»‡nh create_join_table :products, :categories trong Rails Migration Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o báº£ng trung gian (join table) cho quan há»‡ many-to-many giá»¯a products vÃ  categories
ğŸ”¥ Khi nÃ o nÃªn dÃ¹ng change_table?
Khi muá»‘n thay Ä‘á»•i nhiá»u cá»™t trong cÃ¹ng má»™t báº£ng.
Viáº¿t gá»n gÃ ng hÆ¡n thay vÃ¬ gá»i add_column, remove_column tá»«ng dÃ²ng.

âœ… up vÃ  down hoáº¡t Ä‘á»™ng tháº¿ nÃ o?
up: Cháº¡y khi báº¡n cháº¡y rails db:migrate.
down: Cháº¡y khi báº¡n rollback báº±ng rails db:rollback.
---------------------------------------------------------------------------------------
begin
  user = User.find(params[:id])
  data = JSON.parse(some_json)
rescue => e  # Báº¯t táº¥t cáº£ lá»—i
  Rails.logger.error "Lá»—i xáº£y ra: #{e.class} - #{e.message}"
  render json: { error: "ÄÃ£ xáº£y ra lá»—i" }, status: :internal_server_error
end


Bat tat ca loi bang rescue 

------------------------------------------------------------------------------------------
Index trong SQL 
NÃ³ sáº½ chia lÃ m 2 loáº¡i lÃ  cluster vÃ  non cluster. khi báº¡n táº¡o primary key thÃ¬ nÃ³ sáº½ tá»± táº¡o ra cÃ¡i cluster chá»©a táº¥t cáº£ cÃ¡c trÆ°á»ng dá»¯ liá»‡u 

DataBase trong SQL khÃ´ng sáº¯p xáº¿p theo thá»© tá»± mÃ  sáº½ lÃ  ngáº«u nhiÃªn sao cho hiá»‡u suáº¥t tá»‘i Æ°u nháº¥t khi cÃ³ index thÃ¬ báº£ng nÃ³ sáº½ Ä‘c sáº¯p xáº¿p láº¡i theo kiá»ƒu b tree vÃ  theo thá»© tá»± 

khi Ä‘Ã¡nh index thÃ¬ nÃ³ sáº½ Æ°u tiÃªn cá»™t Ä‘áº§u tiÃªn sáº¯p xáº¿p vÃ  hoáº¡t Ä‘á»™ng theo kiá»ƒu b tree cÃ¡c cá»™t cÃ²n láº¡i thÃ¬ lÃ  sáº¯p xáº¿p (Ä‘Ã¡nh index theo dáº¡ng (quiz_id, position) Index sáº½ Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn quiz_id trÆ°á»›c, sau Ä‘Ã³ má»›i Ä‘áº¿n position. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  dá»¯ liá»‡u trong index sáº½ Ä‘Æ°á»£c sáº¯p xáº¿p trÆ°á»›c theo quiz_id, vÃ  vá»›i má»—i quiz_id, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c sáº¯p xáº¿p tiáº¿p theo position.) 

CÃ´ng thá»©c: thá»© tá»± Ä‘Ã¡nh index: tÃ¬m kiáº¿m rá»“i má»›i tá»›i sáº¯p xáº¿p 
nÃªn khi khÃ´ng cÃ³ index nÃ³ sáº½ tÃ¬m kiáº¿m ráº¥t khÃ³ khÄƒn vÃ  pháº£i tÃ¬m kiáº¿m táº¥t cáº£ cÃ¡c dÃ²ng mÃ  má»—i dÃ²ng nÃ³ cÃ²n nhiá»u dá»¯ liá»‡u ná»¯a 
index Ä‘i theo cáº¥u trÃºc cÃ¢y vÃ  náº¿u index lÃ  sá»‘ láº¥y Ä‘iá»ƒm trung bÃ¬nh lÃ m giá»¯a rá»“i chia ra 2 bÃªn, náº¿u lÃ  string thÃ¬ sáº½ chia theo báº£ng chá»¯ cÃ¡i, kÃ­ tá»± Ä‘áº§u cá»§a string 
Index sáº½ láº¥y primary key lÃ  index náº¿u k cÃ³ thÃ¬ nÃ³ dÃ¹ng unique_key de lam khoa chinh 
-------------------------------------------------------------------------------------------
Routes 

get "/about", to: "pages#about"
ğŸ“Œ Truy cáº­p: http://localhost:3000/about
ğŸ“Œ Äiá»u hÆ°á»›ng Ä‘áº¿n: PagesController â†’ about action

root "home#index"
ğŸ“Œ Truy cáº­p: http://localhost:3000/
ğŸ“Œ Äiá»u hÆ°á»›ng Ä‘áº¿n: HomeController â†’ index action

resources :users
ğŸ“Œ Táº¡o 7 routes máº·c Ä‘á»‹nh: index, show, new, create, edit, update, destroy
GET    /users          -> users#index
GET    /users/:id      -> users#show
GET    /users/new      -> users#new
POST   /users          -> users#create
GET    /users/:id/edit -> users#edit
PATCH  /users/:id      -> users#update
DELETE /users/:id      -> users#destroy


resources :users, only: [:index, :show]
Náº¿u khÃ´ng muá»‘n táº¡o táº¥t cáº£ 7 routes cá»§a resources, báº¡n cÃ³ thá»ƒ giá»›i háº¡n láº¡i:

 Custom Routes vá»›i member vÃ  collection
 resources :users do
  member do
    get "profile"  # /users/:id/profile  #member: ThÃªm route liÃªn quan Ä‘áº¿n 1 object (cÃ³ id)
  end
  collection do
    get "search"   # /users/search
  end
end


 Láº¥y tham sá»‘ tá»« URL: get "/users/:id", to: "users#show"
def show
  @user = User.find(params[:id])
end

------------------------------------------------
VIEW
form_with model: @user â†’ Rails tá»± Ä‘á»™ng gá»­i dá»¯ liá»‡u cá»§a user vá» controller.

-------------------------------------------------------------
DÃ¹ng blinding.dry Ä‘á»ƒ debug 

náº¿u nÃ³ chÆ°a vÃ o hÃ m Ä‘Ã³ thÃ¬ chÆ°a cháº¡y Ä‘c Ä‘Ã¢u 

-----------------------------------------------------------------
ğŸ“Œ Kiá»ƒm chá»©ng session riÃªng biá»‡t giá»¯a ngÆ°á»i dÃ¹ng
Báº¡n cÃ³ thá»ƒ kiá»ƒm tra session trong controller báº±ng:
puts "Session ID: #{session.id}"  # ID cá»§a session hiá»‡n táº¡i
puts "Exam Result: #{session[:exam_result]}"  # Dá»¯ liá»‡u session cá»§a user nÃ y
Má»Ÿ hai trÃ¬nh duyá»‡t khÃ¡c nhau (hoáº·c cháº¿ Ä‘á»™ áº©n danh), báº¡n sáº½ tháº¥y session ID khÃ¡c nhau vÃ  dá»¯ liá»‡u cá»§a má»—i user Ä‘á»™c láº­p.


---------------------------------------------------------------

Select tráº£ vá» 1 Ä‘á»‘i tÆ°á»£ng
1ï¸âƒ£ DÃ¹ng select thay vÃ¬ pluck
@question_max = QuizSetting.select(:id, :question_max).find_by(user_id: current_user.id)
ğŸ‘‰ Káº¿t quáº£: Tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng QuizSetting, báº¡n cÃ³ thá»ƒ truy cáº­p trá»±c tiáº¿p @question_max.id vÃ  @question_max.question_max.


-----------------------------------------------------------------

pluck tráº£ vá» 1 máº£ng cÃ³ nhiá»u cá»™t 
2ï¸âƒ£ Náº¿u muá»‘n dÃ¹ng pluck, dÃ¹ng where thay vÃ¬ find_by
@question_max = QuizSetting.where(user_id: current_user.id).pluck(:id, :question_max).first
ğŸ‘‰ Káº¿t quáº£: Tráº£ vá» má»™t máº£ng [id, question_max].
-------------------------------------------------------------------
persisted kiá»ƒm tra xem cÃ³ tá»“n táº¡i trong báº£ng hay k (kieemr trar ow view) 
dÃ¹ng includes Ä‘á»ƒ trÃ¡nh N+1 querry
PhÆ°Æ¡ng thá»©c exists? trong Rails Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra xem má»™t báº£n ghi cÃ³ tá»“n táº¡i trong cÆ¡ sá»Ÿ dá»¯ liá»‡u hay khÃ´ng. NÃ³ tráº£ vá» true náº¿u cÃ³ Ã­t nháº¥t má»™t báº£n ghi khá»›p vá»›i Ä‘iá»u kiá»‡n vÃ  false náº¿u khÃ´ng cÃ³ báº£n ghi nÃ o.

NÃªn ghi táº¥t cáº£ vÃ o 1 máº£ng rá»“i insert 1 lÃºc thay vÃ¬ insert tá»«ng cÃ¡i 1 . VÃ­ dá»¥ phÃ­a dÆ°á»›i
			notices = []
			@user.followers.each do |follower|
			  notices << {
			    user_id: follower.follower_id,
			    message: "#{@user.email} vá»«a hoÃ n thÃ nh bÃ i kiá»ƒm tra!",
			    notification_type: "quiz",
			    status: false
			  }
			end
			Notification.create(notices)

-------------------------------------------------------------------
QUEUE 
tail -f log/sidekiq.log
bundle exec sidekiq -C config/sidekiq.yml

[6] pry(main)> require 'sidekiq/api'
=> false
[7] pry(main)> Sidekiq::RetrySet.new.clear
=> true
[8] pry(main)> Sidekiq::DeadSet.new.clear
=> true
CÃ¡ch truyá»n			Æ¯u Ä‘iá»ƒm			NhÆ°á»£c Ä‘iá»ƒm
Truyá»n object (current_user)	KhÃ´ng cáº§n truy váº¥n láº¡i DB	Náº¿u object bá»‹ xÃ³a trÆ°á»›c khi job cháº¡y, job sáº½ lá»—i
Truyá»n ID (current_user.id)	TrÃ¡nh lá»—i náº¿u object bá»‹ xÃ³a	Cáº§n truy váº¥n láº¡i DB khi job cháº¡y
ğŸ“Œ TÃ³m láº¡i:
Dá»¯ liá»‡u quan trá»ng, cáº§n Ä‘áº£m báº£o job khÃ´ng lá»—i â†’ Truyá»n ID.
Dá»¯ liá»‡u Ã­t khi bá»‹ xÃ³a, muá»‘n tá»‘i Æ°u truy váº¥n DB â†’ Truyá»n object. máº·c Ä‘á»‹nh lÃ  sidekiq khÃ´ng há»— trá»£ kiá»ƒu object nÃªn báº¡n pháº£i DÃ¹ng ActiveJob Serializers  Ä‘á»ƒ chuyá»ƒn Ä‘á»•i object thÃ nh hash (nÃ y chÆ°a lÃ m) hiá»‡n táº¡i cá»© gá»­i string hash interge máº£ng thÃ´i 	


âœ… CÃ“ THá»‚ dÃ¹ng Job Ä‘á»ƒ thÃªm dá»¯ liá»‡u vÃ o báº£ng, nhÆ°ng cáº§n:
Truyá»n ID thay vÃ¬ object Ä‘á»ƒ trÃ¡nh lá»—i khi object bá»‹ xÃ³a
âœ… ActiveRecord Object lÃ  chá»©a Ä‘áº§y Ä‘á»§ dá»¯ liá»‡u cá»§a má»™t báº£n ghi trong database.
DÃ¹ng lock hoáº·c kiá»ƒm tra dá»¯ liá»‡u Ä‘á»ƒ trÃ¡nh race condition

LOCK
ğŸš¨ GÃ¢y cháº­m náº¿u cÃ³ nhiá»u tiáº¿n trÃ¬nh cÃ¹ng truy cáº­p, vÃ¬ má»—i tiáº¿n trÃ¬nh pháº£i chá» khÃ³a Ä‘Æ°á»£c má»Ÿ.
ğŸš¨ Náº¿u má»™t tiáº¿n trÃ¬nh giá»¯ khÃ³a quÃ¡ lÃ¢u, cÃ³ thá»ƒ gÃ¢y deadlock (tiáº¿n trÃ¬nh khÃ¡c pháº£i chá» mÃ£i).
update_all cáº­p nháº­t tháº³ng vÃ o DB, khÃ´ng cáº§n queue, khÃ´ng quan tÃ¢m process khÃ¡c

DÃ¹ng Sidekiq vá»›i retry Ä‘á»ƒ trÃ¡nh job tháº¥t báº¡i khÃ´ng xá»­ lÃ½ láº¡i


THÃŠM Dá»® LIá»†U TRONG LOG
âœ… NÃªn dÃ¹ng insert_all náº¿u cáº§n tá»‘c Ä‘á»™ cao, khÃ´ng cáº§n validation.
âœ… DÃ¹ng import náº¿u váº«n muá»‘n cháº¡y validation & callback.
âœ… KhÃ´ng nÃªn dÃ¹ng .create tá»«ng cÃ¡i náº¿u dá»¯ liá»‡u lá»›n, vÃ¬ cháº­m & tá»‘n tÃ i nguyÃªn.

PROCESS 
Process (tiáº¿n trÃ¬nh) lÃ  má»™t chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y trÃªn há»‡ Ä‘iá»u hÃ nh. Má»—i process cÃ³:
âœ… Bá»™ nhá»› riÃªng (khÃ´ng chia sáº» vá»›i process khÃ¡c).
âœ… TÃ i nguyÃªn riÃªng (file, socket, connection, v.v.).
âœ… CÃ³ thá»ƒ cháº¡y nhiá»u thread bÃªn trong.

ğŸ“Œ VÃ­ dá»¥:
Khi báº¡n cháº¡y rails server, nÃ³ táº¡o ra má»™t process Ä‘á»ƒ xá»­ lÃ½ web requests.
Khi báº¡n cháº¡y bundle exec sidekiq, nÃ³ táº¡o ra má»™t Sidekiq worker process Ä‘á»ƒ xá»­ lÃ½ job.
ğŸ“Œ HÃ¬nh dung:
Má»™t process giá»‘ng nhÆ° má»™t nhÃ  hÃ ng â†’ Má»—i nhÃ  hÃ ng cÃ³ nhiá»u nhÃ¢n viÃªn (thread) lÃ m viá»‡c.


THREAD 
Thread (luá»“ng) lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t cá»§a má»™t process, giÃºp thá»±c hiá»‡n nhiá»u tÃ¡c vá»¥ song song.
âœ… Nhiá»u thread trong má»™t process cÃ³ thá»ƒ chia sáº» bá»™ nhá»› vÃ  tÃ i nguyÃªn.
âœ… Táº¡o thread nhanh hÆ¡n táº¡o process má»›i vÃ¬ nÃ³ dÃ¹ng chung bá»™ nhá»› cá»§a process.
âœ… Thread cÃ¹ng má»™t process cÃ³ thá»ƒ giao tiáº¿p vá»›i nhau dá»… dÃ ng hÆ¡n process khÃ¡c.

ğŸ“Œ VÃ­ dá»¥:
Trong má»™t process Sidekiq, cÃ³ thá»ƒ cÃ³ 5 thread xá»­ lÃ½ 5 job cÃ¹ng lÃºc.
Trong web server Puma, cÃ³ thá»ƒ cÃ³ nhiá»u thread xá»­ lÃ½ nhiá»u request cÃ¹ng lÃºc.
ğŸ“Œ HÃ¬nh dung:
Thread giá»‘ng nhÆ° nhiá»u nhÃ¢n viÃªn trong cÃ¹ng má»™t nhÃ  hÃ ng (process), cÃ¹ng lÃ m viá»‡c Ä‘á»ƒ phá»¥c vá»¥ khÃ¡ch.


WORKER 
Worker lÃ  má»™t thuáº­t ngá»¯ chung Ä‘á»ƒ chá»‰ má»™t Ä‘Æ¡n vá»‹ thá»±c thi cÃ´ng viá»‡c (job). NÃ³ cÃ³ thá»ƒ lÃ :
âœ… Má»™t process (vÃ­ dá»¥: má»™t process Sidekiq).
âœ… Má»™t thread trong má»™t process.
âœ… Má»™t mÃ¡y chá»§ riÃªng biá»‡t cháº¡y cÃ¡c job (vÃ­ dá»¥: má»™t container Sidekiq worker trÃªn Kubernetes).

ğŸ“Œ VÃ­ dá»¥:
Khi báº¡n cháº¡y Sidekiq, nÃ³ táº¡o ra má»™t worker process.
Worker nÃ y cÃ³ thá»ƒ cháº¡y nhiá»u thread bÃªn trong Ä‘á»ƒ xá»­ lÃ½ job song song.
Khi cÃ³ nhiá»u job cáº§n xá»­ lÃ½, báº¡n cÃ³ thá»ƒ cháº¡y nhiá»u worker process trÃªn nhiá»u server.
ğŸ“Œ HÃ¬nh dung:
Worker giá»‘ng nhÆ° má»™t nhÃ  hÃ ng phá»¥, cÃ³ thá»ƒ chá»©a nhiá»u nhÃ¢n viÃªn (thread) Ä‘á»ƒ phá»¥c vá»¥ khÃ¡ch hÃ ng.

âœ… Táº¡o má»™t process Sidekiq vá»›i 5 thread.
âœ… Trong Ä‘Ã³:
5 thread Æ°u tiÃªn critical.
3 thread xá»­ lÃ½ default.
1 thread xá»­ lÃ½ low.
nhÆ° nÃ y thÃ¬ khi xá»­ lÃ½ xong critical thÃ¬ nÃ³ sáº½ xá»­ lÃ½ default vÃ  low cÃ¹ng lÃºc 


ğŸ§  Váº­y nÃªn tÄƒng workers hay threads?
DÃ¹ 5 x 10 = 50 hay 2 x 25 = 50 Ä‘á»u xá»­ lÃ½ Ä‘Æ°á»£c 50 request cÃ¹ng lÃºc, nhÆ°ng báº£n cháº¥t hoáº¡t Ä‘á»™ng cá»§a chÃºng ráº¥t khÃ¡c, áº£nh hÆ°á»Ÿng Ä‘áº¿n:

TiÃªu chÃ­		workers							threads
LÃ  gÃ¬?			Process Ä‘á»™c láº­p					Thread trong 1 process
DÃ¹ng CPU tháº¿ nÃ o?	Tá»‘t cho CPU-bound (nhiá»u nhÃ¢n)				Tá»‘t cho I/O-bound (chá» DB, API,...)
Tá»‘n RAM		Cao hÆ¡n (má»—i worker lÃ  process riÃªng)			Tháº¥p hÆ¡n
Chia táº£i CPU		Tá»‘t (Ä‘a core hoáº¡t Ä‘á»™ng hiá»‡u quáº£)			KhÃ´ng chia core, dÃ¹ng trong core hiá»‡n táº¡i
Äá»™ á»•n Ä‘á»‹nh		Náº¿u 1 worker crash thÃ¬ cÃ¡c worker khÃ¡c váº«n sá»‘ng	Náº¿u 1 thread lá»—i cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng process

âœ… Khi nÃ o tÄƒng workers?
MÃ¡y báº¡n cÃ³ nhiá»u nhÃ¢n CPU (vd: 4 cores â†’ set workers = 4)

App cÃ³ xá»­ lÃ½ náº·ng vá» tÃ­nh toÃ¡n

Báº¡n muá»‘n tÃ¡ch biá»‡t tiáº¿n trÃ¬nh Ä‘á»ƒ tÄƒng Ä‘á»™ á»•n Ä‘á»‹nh

âœ… Khi nÃ o tÄƒng threads?
App cá»§a báº¡n I/O-bound (chá» Redis, DB, gá»i API)

Muá»‘n tiáº¿t kiá»‡m RAM

Ãt core nhÆ°ng nhiá»u káº¿t ná»‘i cáº§n chá» Ä‘á»£i


-------------------------------------------------
ELASTICSEARCH 

sudo systemctl start elasticsearch
sudo systemctl stop elasticsearch
sudo systemctl status elasticsearch
1. Kiá»ƒm tra Elasticsearch Ä‘ang cháº¡y
curl -X GET "http://localhost:9200"
ğŸ”¹ 3. Liá»‡t kÃª táº¥t cáº£ index
curl -X GET "http://localhost:9200/_cat/indices?v"
ğŸ”¹ 4. Táº¡o má»™t index má»›i
curl -X PUT "http://localhost:9200/my_index"
ğŸ”¹ 5. XÃ³a má»™t index
curl -X DELETE "http://localhost:9200/my_index"
2ï¸âƒ£ Re-index láº¡i dá»¯ liá»‡u tá»« database
rails runner 'User.__elasticsearch__.import'
-----------------------------------------------------------------
BACKUP DB 
âœ… Khi nÃ o dÃ¹ng Binary Log, khi nÃ o dÃ¹ng Cronjob?
ğŸ”¹ DÃ¹ng Binary Log náº¿u:

Cáº§n khÃ´i phá»¥c nhanh sau sá»± cá»‘ (há»‡ thá»‘ng tÃ i chÃ­nh, ngÃ¢n hÃ ng, v.v.).

Cáº§n backup cáº£ dá»¯ liá»‡u láº«n thay Ä‘á»•i theo thá»i gian thá»±c.

ğŸ”¹ DÃ¹ng Cronjob náº¿u:

Chá»‰ cáº§n backup Ä‘á»‹nh ká»³ (háº±ng ngÃ y, háº±ng tuáº§n).

KhÃ´ng cáº§n phá»¥c há»“i tá»«ng thay Ä‘á»•i nhá» mÃ  chá»‰ cáº§n backup tá»•ng thá»ƒ.

crontab -e (dÃ¹ng lá»‡nh nÃ y Ä‘á»ƒ vÃ´ chá»‰nh)
cáº¥u hÃ¬nh láº¡i PATH trong crontab! ğŸš€
TrÆ°á»›c Ä‘Ã¢y, cronjob dÃ¹ng Ruby há»‡ thá»‘ng (3.0.2), nÃªn bá»‹ lá»—i version.
BÃ¢y giá» báº¡n Ä‘Ã£ Ä‘áº·t PATH Ä‘á»ƒ Æ°u tiÃªn Ruby tá»« rbenv, nÃªn nÃ³ cháº¡y Ä‘Ãºng Ruby 3.1.2 cá»§a báº¡n.

âœ… LuÃ´n Ä‘áº·t PATH trong crontab -e náº¿u dÃ¹ng rbenv.
âœ… DÃ¹ng /bin/bash -l -c náº¿u cronjob cáº§n náº¡p biáº¿n mÃ´i trÆ°á»ng.
âœ… DÃ¹ng bundle exec Ä‘á»ƒ cháº¡y Rails vá»›i Ä‘Ãºng gem.

------------------------------------------------------------------
Query trong rails 
Báº¡n khÃ´ng cáº§n cáº¥u hÃ¬nh query parameters trong routes.rb vÃ¬ Rails tá»± Ä‘á»™ng xá»­ lÃ½ chÃºng tá»« URL.
<%= link_to "Admin Users", users_path(role: 'admin', page: 2) %>
Káº¿t quáº£ lÃ , khi ngÆ°á»i dÃ¹ng click vÃ o liÃªn káº¿t, URL sáº½ trÃ´ng nhÆ° sau:
/users?role=admin&page=2

----------------------------------------------------------------------
rails s -p 3002 -b 192.168.0.35
----------------------------------------------------------------------
Transaction trong SQL lÃ  má»™t nhÃ³m cÃ¡c cÃ¢u lá»‡nh SQL. Náº¿u má»™t transaction Ä‘Æ°á»£c thá»±c hiá»‡n thÃ nh cÃ´ng, táº¥t cáº£ cÃ¡c thay Ä‘á»•i dá»¯ liá»‡u Ä‘Æ°á»£c thá»±c hiá»‡n trong transaction Ä‘Æ°á»£c lÆ°u vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u. Náº¿u má»™t transaction bá»‹ lá»—i vÃ  Ä‘Æ°á»£c rollback, thÃ¬ táº¥t cáº£ cÃ¡c sá»­a Ä‘á»•i dá»¯ liá»‡u sáº½ bá»‹ xÃ³a (dá»¯ liá»‡u Ä‘Æ°á»£c khÃ´i phá»¥c vá» tráº¡ng thÃ¡i trÆ°á»›c khi thá»±c hiá»‡n transaction).
Transaction dÃ¹ng khi: TÃ¡c Ä‘á»™ng nhiá»u báº£ng cÃ¹ng lÃºc (user, order, profile,...)	

ğŸ§  Transaction khÃ¡c lÃ  gÃ¬?
â†’ LÃ  transaction khÃ¡c biá»‡t, Ä‘Æ°á»£c má»Ÿ á»Ÿ má»™t káº¿t ná»‘i (session) khÃ¡c vá»›i transaction hiá»‡n táº¡i.
â†’ KhÃ´ng quan trá»ng lÃ  tá»« user khÃ¡c hay cÃ¹ng 1 user, chá»‰ cáº§n lÃ  má»™t transaction khÃ¡c thÃ¬ Ä‘á»u tÃ­nh lÃ  â€œtransaction khÃ¡câ€.

á»Ÿ bÃªn ngoÃ i transaction thÃ¬ hÃ nh Ä‘á»™ng lÃ  riÃªng láº» náº¿u tháº¥t báº¡i thÃ¬ k lÆ°u vÃ o db, cÃ³ ! thÃ¬ bÃ¡o lá»—i khÃ´ng cÃ³ ! thÃ¬ k bÃ¡o. á»Ÿ trong transaction thÃ¬ rollback láº¡i táº¥t náº¿u cÃ³ lá»—i 
! â†’ bÃ¡o lá»—i (náº¿u cÃ³)
transaction â†’ rollback náº¿u cÃ³ lá»—i
â†’ DÃ¹ng cáº£ hai má»›i Ä‘áº£m báº£o an toÃ n dá»¯ liá»‡u
-----------------------------------------------------------------------------
Xá»­ lÃ½ trong TRANSACTION 
âœ… CÃ¡c method nhÆ° save, destroy KHÃ”NG cáº§n ! Ä‘á»ƒ rollback:
VÃ¬ chÃºng Ä‘Ã£ Ä‘Æ°á»£c ActiveRecord tá»± Ä‘á»™ng bá»c trong transaction.
Náº¿u validation sai hoáº·c cÃ³ exception trong callback, Rails tá»± rollback.
KhÃ´ng cáº§n !, chá»‰ cáº§n báº¡n xá»­ lÃ½ Ä‘Ãºng káº¿t quáº£ tráº£ vá» (true/false).


PostgreSQL máº·c Ä‘á»‹nh Ä‘Ã£ cáº¥u hÃ¬nh sáºµn má»©c isolation level lÃ  READ COMMITTED vÃ  Ä‘Ã¢y lÃ  má»©c an toÃ n khá»i "dirty read" rá»“i. ğŸ” KhÃ´ng cho phÃ©p Ä‘á»c dá»¯ liá»‡u chÆ°a commit
â›” Tá»©c lÃ :
Khi T1 muá»‘n Ä‘á»c 1 báº£n ghi, thÃ¬ nÃ³ chá»‰ Ä‘Æ°á»£c Ä‘á»c giÃ¡ trá»‹ cuá»‘i cÃ¹ng Ä‘Ã£ commit, dÃ¹ cÃ³ session khÃ¡c Ä‘ang sá»­a cÅ©ng khÃ´ng Ä‘Æ°á»£c nhÃ¬n tháº¥y.

ğŸ§¨ 1. Dirty Read (Äá»c dá»¯ liá»‡u "báº©n", chÆ°a commit)
ğŸ” MÃ´ táº£:
Transaction 2 (T2) update báº£n ghi nhÆ°ng chÆ°a commit
Transaction 1 (T1) Ä‘á»c báº£n ghi Ä‘Ã³ trong khi nÃ³ váº«n Ä‘ang "táº¡m thá»i"
Sau Ä‘Ã³ T2 rollback, vÃ  T1 Ä‘ang cáº§m dá»¯ liá»‡u khÃ´ng tá»“n táº¡i ğŸ¤¯

MySQL thÃ¬ ngoÃ i trÃ¡nh dirty read, nÃ³ cÃ²n trÃ¡nh non-repeatable read luÃ´n, tá»©c lÃ :

ğŸ” 2. Non-repeatable Read (Äá»c khÃ´ng láº·p láº¡i Ä‘Æ°á»£c)
ğŸ” MÃ´ táº£:
T1 Ä‘á»c báº£n ghi X láº§n Ä‘áº§u
T2 sá»­a báº£n ghi X vÃ  commit
T1 Ä‘á»c láº¡i báº£n ghi X vÃ  tháº¥y giÃ¡ trá»‹ khÃ¡c â†’ gÃ¢y lá»—i logic (náº¿u Ä‘ang xá»­ lÃ½ logic tá»« láº§n Ä‘á»c Ä‘áº§u)

âœ… CÃ¡ch xá»­ lÃ½:
DÃ¹ng isolation level: REPEATABLE READ hoáº·c SERIALIZABLE (cai nay de xu ly phantom gio t chua hoc dc)

REPEATABLE READ
T1 Ä‘á»c snapshot cá»‘ Ä‘á»‹nh Báº¢N GHI cá»§a dá»¯ liá»‡u ngay tá»« láº§n Ä‘á»c Ä‘áº§u tiÃªn
KhÃ´ng bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi cÃ¡c commit sau Ä‘Ã³ cá»§a transaction khÃ¡c

Hoáº·c dÃ¹ng .lock Ä‘á»ƒ khÃ³a báº£n ghi khi T1 Ä‘ang xá»­ lÃ½
 user = User.lock.find(1)  # SELECT FOR UPDATE
  # giá» khÃ´ng ai cÃ³ thá»ƒ sá»­a user nÃ y cho Ä‘áº¿n khi T1 commit
  
  
  VÃ­ dá»¥ thá»±c táº¿ Ä‘á»ƒ k bá»‹ nháº§m db sáº½ k tá»± Ä‘á»™ng truy váº¥n láº¡i nhá»¯ng hÃ m trong transaction - trÆ°á»ng há»£p bá»‹ láº·p nhÆ° vÃ­ dá»¥ dÆ°á»›i thÃ¬ má»›i cáº§n pháº£i Ä‘á»ƒ Ã½ REPEATABLE READ hoáº·c READ COMMITTED
  
  # Terminal 1
User.transaction(isolation: :repeatable_read) do
  puts "First Read:"
  p User.where("age > 18").pluck(:name)

  puts "â³ Sleeping 10s..."
  sleep 10

  puts "Second Read:"
  p User.where("age > 18").pluck(:name)
end


# Terminal 2 (trong vÃ²ng 10s)
User.create(name: "Quá»‘c Anh", age: 25)

 LÃºc cháº¡y xong báº¡n sáº½ khÃ´ng tháº¥y "Quá»‘c Anh" trong láº§n Ä‘á»c thá»© 2 náº¿u isolation = :repeatable_read
â†’ Náº¿u Ä‘á»ƒ máº·c Ä‘á»‹nh (read committed) thÃ¬ sáº½ tháº¥y Quá»‘c Anh á»Ÿ láº§n Ä‘á»c thá»© 2.


Má»©c Isolation			Khi nÃ o dÃ¹ng					TrÃ¡nh Ä‘Æ°á»£c gÃ¬		Hiá»‡u nÄƒng
READ COMMITTED (default)	Háº§u háº¿t CRUD bÃ¬nh thÆ°á»ng			Dirty Read		Nhanh, phá»• biáº¿n
REPEATABLE READ			Logic Ä‘á»c rá»“i update/phá»¥ thuá»™c dá»¯ liá»‡u cÅ©	Dirty + Non-repeatable	Cháº­m hÆ¡n chÃºt
SERIALIZABLE			Pháº£i Ä‘áº£m báº£o tuyá»‡t Ä‘á»‘i, nhÆ° kiá»ƒm tra sá»‘ lÆ°á»£ng	Táº¥t cáº£			Cháº­m nháº¥t, dá»… deadlock




--------------------------------------------
1. turbo-frame â€” cáº­p nháº­t pháº§n tá»­ HTML cá»¥ thá»ƒ (thay tháº¿ trá»±c tiáº¿p)
â†’ Khi click link, server tráº£ vá» HTML (view) vÃ  nÃ³ thay toÃ n bá»™ ná»™i dung trong turbo-frame.

2. turbo-stream â€” thá»±c thi hÃ nh Ä‘á»™ng (append, remove, update...) lÃªn DOM
Báº¡n muá»‘n thá»±c hiá»‡n hÃ nh vi nhÆ°: append, prepend, replace, remove... vá»›i pháº§n tá»­ DOM nÃ o Ä‘Ã³.
Ráº¥t phÃ¹ há»£p cho tÆ°Æ¡ng tÃ¡c thá»i gian thá»±c, vÃ­ dá»¥ thÃªm bÃ¬nh luáº­n, xÃ³a dÃ²ng, cáº­p nháº­t danh sÃ¡ch.

DÃ¹ng turbo-frame khi báº¡n muá»‘n load vÃ  thay tháº¿ vÃ¹ng HTML cá»¥ thá»ƒ â€” giá»‘ng nhÆ° iframe ná»™i bá»™.
DÃ¹ng turbo-stream khi báº¡n muá»‘n Ä‘iá»u khiá»ƒn hÃ nh vi DOM chi tiáº¿t hÆ¡n nhÆ° append/xÃ³a/update tá»«ng pháº§n tá»­.
-----------------------------------------------


LOGSTASH 
sudo nano /etc/logstash/conf.d/sidekiq.conf
sudo systemctl start logstash
sudo /usr/share/logstash/bin/logstash -f /etc/logstash/conf.d/sidekiq.conf 
Cáº§n má»Ÿ cÃ¡i sudo trÃªn má»›i cháº¡y Ä‘c cÅ©ng k bt vÃ¬ sao chÆ°a fix Ä‘c (cháº£ hiá»ƒu sao mÃ  pháº£i cháº¡y lá»‡nh thá»§ cÃ´ng nhÆ° tháº¿ trong khi cháº¡y lá»‡nh start thÃ¬ nÃ³ pháº£i tá»± Ä‘á»™ng cháº¡y cÃ¡i file conf.d/* rá»“i chá»© 
-> Ã  hÃ¬nh nhÆ° pháº£i táº£i daemon vá» 

=========================================
console.log("1");
const order = await Order.findOne({ _id: 123 }); // giáº£ sá»­ máº¥t 2 giÃ¢y
console.log("2");
Thá»i Ä‘iá»ƒm  		Chuyá»‡n gÃ¬ xáº£y ra
0s 			console.log("1") cháº¡y ngay
0.01s 			Order.findOne() gá»­i query Ä‘i MongoDB (á»Ÿ táº§ng dÆ°á»›i, khÃ´ng náº±m trong JS)
0.02s  			await táº¡m Dá»ªNG code JS á»Ÿ Ä‘Ã¢y, vÃ  tráº£ quyá»n láº¡i cho event loop
2.0s  			MongoDB tráº£ káº¿t quáº£ â†’ callback (console.log("2")) Ä‘Æ°á»£c Ä‘Æ°a vÃ o queue
2.01s  			Event loop tháº¥y call stack ráº£nh â†’ Ä‘áº©y console.log("2") lÃªn call stack vÃ  cháº¡y

Luá»“ng chÃ­nh nÃ©m ra luá»“ng ngoÃ i k chá» mÃ  cho luá»“ng ngoÃ i xá»­ lÃ½ xong thÃ¬ nÃ©m vÃ o event loop queue. khi nÃ o luá»“ng chÃ­nh ráº£nh thÃ¬ láº¥y á»Ÿ queue lÃªn xá»­ lÃ½ tiáº¿p 

Náº¿u báº¡n khÃ´ng sá»­ dá»¥ng await vá»›i cÃ¡c tÃ¡c vá»¥ báº¥t Ä‘á»“ng bá»™ trong Node.js (hoáº·c khÃ´ng sá»­ dá»¥ng .then() vá»›i Promises), cÃ¡c tÃ¡c vá»¥ nÃ y sáº½ váº«n thá»±c thi báº¥t Ä‘á»“ng bá»™ nhÆ°ng chÆ°Æ¡ng trÃ¬nh sáº½ khÃ´ng Ä‘á»£i káº¿t quáº£ vÃ  sáº½ tiáº¿p tá»¥c thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ tiáº¿p theo mÃ  khÃ´ng quan tÃ¢m Ä‘áº¿n káº¿t quáº£ cá»§a tÃ¡c vá»¥ báº¥t Ä‘á»“ng bá»™.

NULL VÃ€ UNDERFILE VÃ¬ váº­y, khi muá»‘n kiá»ƒm tra xem má»™t biáº¿n Ä‘Ã£ Ä‘Æ°á»£c khá»Ÿi táº¡o hay chÆ°a, báº¡n nÃªn sá»­ dá»¥ng undefined, trong khi khi muá»‘n chá»‰ Ä‘á»‹nh rÃµ rÃ ng ráº±ng má»™t giÃ¡ trá»‹ khÃ´ng cÃ³ Ã½ nghÄ©a thÃ¬ nÃªn sá»­ dá»¥ng null.

var: Do nhá»¯ng háº¡n cháº¿ vá» pháº¡m vi vÃ  hoisting, var Ã­t Ä‘Æ°á»£c khuyáº¿n khÃ­ch sá»­ dá»¥ng trong cÃ¡c dá»± Ã¡n JavaScript hiá»‡n Ä‘áº¡i
let: ThÃ­ch há»£p cho cÃ¡c biáº¿n cÃ³ giÃ¡ trá»‹ thay Ä‘á»•i, vÃ­ dá»¥ nhÆ° trong vÃ²ng láº·p hoáº·c cÃ¡c Ä‘iá»u kiá»‡n logic
const: ThÃ­ch há»£p cho cÃ¡c biáº¿n cÃ³ giÃ¡ trá»‹ khÃ´ng thay Ä‘á»•i sau khi Ä‘Æ°á»£c khai bÃ¡o, giÃºp tÄƒng tÃ­nh báº£o máº­t vÃ  dá»… Ä‘á»c cá»§a mÃ£
TÃ³m láº¡i, let vÃ  const Ä‘Æ°á»£c giá»›i thiá»‡u trong ES6 nhÆ° lÃ  nhá»¯ng cáº£i tiáº¿n so vá»›i var, vá»›i má»¥c Ä‘Ã­ch giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» liÃªn quan Ä‘áº¿n pháº¡m vi vÃ  hoisting cá»§a var. Sá»­ dá»¥ng let vÃ  const giÃºp lÃ m cho mÃ£ JavaScript trá»Ÿ nÃªn dá»… Ä‘á»c vÃ  dá»… báº£o trÃ¬ hÆ¡n.

----------------------- let chá»‰ bá»‹ giá»›i háº¡n bá»Ÿi block scope (náº±m trong {} nÃ o thÃ¬ chá»‰ sá»‘ng trong Ä‘Ã³) --------------------------------------
Náº¿u báº¡n khai bÃ¡o let á»Ÿ ngoÃ i táº¥t cáº£ cÃ¡c function, thÃ¬ má»i function sau Ä‘Ã³ Ä‘á»u truy cáº­p Ä‘Æ°á»£c miá»…n lÃ  cÃ¹ng scope.
DÃ¹ng var lastValue = null; á»Ÿ trong funcation thÃ¬ biáº¿n nÃ y sáº½ náº±m trong function scope (hoáº·c global scope náº¿u khÃ´ng trong function). Náº¿u báº¡n load file JS nÃ y vÃ o browser á»Ÿ cháº¿ Ä‘á»™ non-module, thÃ¬ lastValue sáº½ thÃ nh window.lastValue, nghÄ©a lÃ  file JS khÃ¡c (cÃ¹ng cháº¡y trong trang) cÅ©ng cÃ³ thá»ƒ Ä‘á»c/ghi.

DÃ¹ng let lastValue = null; thÃ¬ biáº¿n nÃ y khÃ´ng gáº¯n vÃ o window, nÃªn file JS khÃ¡c sáº½ khÃ´ng truy cáº­p trá»±c tiáº¿p Ä‘Æ°á»£c (trá»« khi import/export chung scope).



| Thuá»™c tÃ­nh            | `var`                          | `let`                 | `const`               |
| --------------------- | ------------------------------ | --------------------- | --------------------- |
| **Scope (pháº¡m vi)**   | Function-scoped                | Block-scoped          | Block-scoped          |
| **CÃ³ hoisting**       | âœ… CÃ³ (giÃ¡ trá»‹: `undefined`)    | âœ… CÃ³ (giÃ¡ trá»‹: TDZ\*) | âœ… CÃ³ (giÃ¡ trá»‹: TDZ\*) |
| **GÃ¡n láº¡i giÃ¡ trá»‹ biáº¿n| âœ… CÃ³ thá»ƒ                       | âœ… CÃ³ thá»ƒ              | âŒ KhÃ´ng Ä‘Æ°á»£c          |
| **Khai bÃ¡o láº¡i biáº¿n** | âœ… CÃ³ thá»ƒ                       | âŒ KhÃ´ng thá»ƒ           | âŒ KhÃ´ng thá»ƒ           |
| **Dá»… gÃ¢y lá»—i khÃ´ng?** | âœ… Dá»… (do hoisting + scope yáº¿u) | âŒ An toÃ n hÆ¡n         | âŒ An toÃ n nháº¥t        |


GÃ¡n hÃ m cho biáº¿n, dÃ¹ng nhÆ° dá»¯ liá»‡u	Anonymous function
 arrow function cÅ©ng lÃ  má»™t loáº¡i anonymous function, chá»‰ lÃ  cÃ³ cÃº phÃ¡p ngáº¯n gá»n hÆ¡n vÃ  má»™t sá»‘ hÃ nh vi khÃ¡c.
 
 // anonymous function
const add1 = function(a, b) {
  return a + b;
};

// arrow function
const add2 = (a, b) => a + b;


ğŸ“Œ 1. "use strict" lÃ  gÃ¬?
LÃ  cháº¿ Ä‘á»™ nghiÃªm ngáº·t (strict mode) cá»§a JavaScript.

Khi báº­t lÃªn, JavaScript sáº½:

Báº¯t lá»—i cháº·t cháº½ hÆ¡n (nhiá»u lá»—i mÃ  bÃ¬nh thÆ°á»ng JS bá» qua, giá» sáº½ throw error).

VÃ´ hiá»‡u hÃ³a má»™t sá»‘ cÃº phÃ¡p khÃ´ng an toÃ n.

Chuáº©n hÃ³a hÃ nh vi giá»¯a cÃ¡c trÃ¬nh duyá»‡t.


--------------------------------------------------------------------------------------------------

Ai cÅ©ng Ä‘á»c Ä‘Æ°á»£c ná»™i dung, nhÆ°ng khÃ´ng ai Ä‘Æ°á»£c phÃ©p sá»­a.

VÃ­ dá»¥: JWT, Rails message_verifier.
CÃ¡ch hoáº¡t Ä‘á»™ng:

Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c Base64 encode thÃ nh payload.

KÃ¨m theo Ä‘Ã³ lÃ  má»™t chá»¯ kÃ½ sá»‘ (HMAC) dÃ¹ng secret key.

Khi nháº­n token, server sáº½ decode payload, tÃ­nh láº¡i chá»¯ kÃ½ tá»« payload + secret key.

Náº¿u chá»¯ kÃ½ trÃ¹ng â†’ token há»£p lá»‡.
Náº¿u chá»¯ kÃ½ sai â†’ token bá»‹ chá»‰nh sá»­a â†’ reject.

Äáº·c Ä‘iá»ƒm:
KhÃ´ng Ä‘áº£m báº£o tÃ­nh bÃ­ máº­t.
Äáº£m báº£o tÃ­nh toÃ n váº¹n.

=================

KhÃ´ng ai Ä‘Æ°á»£c phÃ©p Ä‘á»c ná»™i dung, ká»ƒ cáº£ khi cÃ³ token.

VÃ­ dá»¥: Rails message_encryptor, JWT + encryption (JWE).
CÃ¡ch hoáº¡t Ä‘á»™ng:

Dá»¯ liá»‡u Ä‘Æ°á»£c mÃ£ hÃ³a Ä‘á»‘i xá»©ng báº±ng má»™t secret key.

Token tráº£ vá» lÃ  má»™t chuá»—i khÃ´ng thá»ƒ Ä‘á»c Ä‘Æ°á»£c.

Khi verify, server sáº½ giáº£i mÃ£ token, náº¿u sai key â†’ lá»—i.

Äáº·c Ä‘iá»ƒm:

Äáº£m báº£o tÃ­nh bÃ­ máº­t + toÃ n váº¹n.





================================================================================================

Group: DÃ¹ng Ä‘á»ƒ gom nhÃ³m cÃ¡c báº£n ghi cÃ³ giÃ¡ trá»‹ giá»‘ng nhau á»Ÿ má»™t hoáº·c nhiá»u cá»™t.
ThÆ°á»ng Ä‘i kÃ¨m vá»›i cÃ¡c hÃ m tá»•ng há»£p (aggregate functions) nhÆ°:
COUNT(), SUM(), AVG(), MAX(), MIN().

| id | customer\_id | amount |
| -- | ------------ | ------ |
| 1  | 1            | 100    |
| 2  | 2            | 200    |
| 3  | 1            | 150    |
| 4  | 2            | 300    |
| 5  | 3            | 50     |
SELECT customer_id, SUM(amount) AS total_amount
FROM orders
GROUP BY customer_id;
| customer\_id | total\_amount |
| ------------ | ------------- |
| 1            | 250           |
| 2            | 500           |
| 3            | 50            |


2. HAVING â€“ Lá»c sau khi nhÃ³m
Ã nghÄ©a: Giá»‘ng WHERE, nhÆ°ng Ã¡p dá»¥ng sau GROUP BY.

DÃ¹ng Ä‘á»ƒ lá»c cÃ¡c nhÃ³m dá»±a trÃªn káº¿t quáº£ cá»§a cÃ¡c hÃ m tá»•ng há»£p.
WHERE lá»c trÆ°á»›c khi nhÃ³m â†’ HAVING lá»c sau khi nhÃ³m.

SELECT customer_id, SUM(amount) AS total_amount
FROM orders
GROUP BY customer_id
HAVING SUM(amount) >= 200;
| customer\_id | total\_amount |
| ------------ | ------------- |
| 1            | 250           |
| 2            | 500           |

JOIN: GhÃ©p 2 báº£ng láº¡i vá»›i nhau vá»›i Ä‘iá»u kiá»‡n nháº¥t Ä‘á»‹nh (cÃ¡c báº£n ghi cÃ³ cÃ¹ng id cháº³ng háº¡n) 
CÃ³ 6 loáº¡i JOIN phá»• biáº¿n:
INNER JOIN
LEFT JOIN (hoáº·c LEFT OUTER JOIN)
RIGHT JOIN (hoáº·c RIGHT OUTER JOIN)
FULL JOIN (hoáº·c FULL OUTER JOIN)
CROSS JOIN
SELF JOIN


| customer\_id | name |
| ------------ | ---- |
| 1            | An   |
| 2            | BÃ¬nh |
| 3            | Chi  |
| 4            | DÅ©ng |

| order\_id | customer\_id | product |
| --------- | ------------ | ------- |
| 101       | 1            | iPhone  |
| 102       | 1            | MacBook |
| 103       | 2            | iPad    |
| 104       | 3            | AirPods |

1. INNER JOIN
Láº¥y cÃ¡c báº£n ghi cÃ³ giÃ¡ trá»‹ trÃ¹ng khá»›p á»Ÿ cáº£ 2 báº£ng.

| name | product |
| ---- | ------- |
| An   | iPhone  |
| An   | MacBook |
| BÃ¬nh | iPad    |
| Chi  | AirPods |

2. LEFT JOIN
Láº¥y táº¥t cáº£ báº£n ghi bÃªn trÃ¡i, náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u khá»›p thÃ¬ tráº£ NULL bÃªn pháº£i.

| name | product |
| ---- | ------- |
| An   | iPhone  |
| An   | MacBook |
| BÃ¬nh | iPad    |
| Chi  | AirPods |
| DÅ©ng | NULL    |

4. FULL JOIN
Láº¥y táº¥t cáº£ báº£n ghi cá»§a cáº£ 2 báº£ng, náº¿u khÃ´ng khá»›p thÃ¬ tráº£ NULL cho bÃªn cÃ²n thiáº¿u.

| name | product |
| ---- | ------- |
| An   | iPhone  |
| An   | MacBook |
| BÃ¬nh | iPad    |
| Chi  | AirPods |
| DÅ©ng | NULL    |


| Loáº¡i JOIN  | Dá»¯ liá»‡u tá»« báº£ng trÃ¡i | Dá»¯ liá»‡u tá»« báº£ng pháº£i | Khi khÃ´ng khá»›p      |
| ---------- | --------------------  | --------------------  | -------------------  |
| INNER JOIN | âœ… náº¿u khá»›p           | âœ… náº¿u khá»›p           | Bá» qua              |
| LEFT JOIN  | âœ… táº¥t cáº£             | âœ… náº¿u khá»›p           | NULL bÃªn pháº£i       |
| RIGHT JOIN | âœ… náº¿u khá»›p           | âœ… táº¥t cáº£             | NULL bÃªn trÃ¡i       |
| FULL JOIN  | âœ… táº¥t cáº£             | âœ… táº¥t cáº£             | NULL náº¿u khÃ´ng khá»›p |
| CROSS JOIN | âœ… táº¥t cáº£             | âœ… táº¥t cáº£             | KhÃ´ng cÃ³ Ä‘iá»u kiá»‡n  |
| SELF JOIN  | DÃ¹ng chÃ­nh báº£ng      | DÃ¹ng chÃ­nh báº£ng      | Alias Ä‘á»ƒ phÃ¢n biá»‡t  |

=============================================

| Biá»ƒu thá»©c bÃªn pháº£i `await` | Khi nÃ o cháº¡y              | CÃ¡i gÃ¬ bá»‹ pause                         |
| -------------------------- | ------------------------- | --------------------------------------- |
| **KhÃ´ng pháº£i Promise**     | Cháº¡y ngay                 | Code sau `await`                        |
| **Promise**                | Promise báº¯t Ä‘áº§u cháº¡y ngay | Code sau `await` sáº½ Ä‘á»£i Promise resolve |
